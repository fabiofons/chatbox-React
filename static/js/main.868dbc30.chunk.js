(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,a){},53:function(e,t,a){e.exports=a(93)},58:function(e,t,a){},86:function(e,t){},93:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(48),c=a.n(r),i=(a(58),a(8)),o=a(9),u=a(11),l=a(10),m=a(12),h=a(50),p=a(5),d=(a(24),a(6)),f=a.n(d),v=a(16),b={id:"",name:""},g=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).state={user:""},e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("div",{className:"login"},s.a.createElement("form",{className:"chart",onSubmit:this.handleSubmit.bind(this)},s.a.createElement("h3",null,"\xbfCu\xe1l es tu nombre?"),s.a.createElement("input",{type:"text",className:"inputlogin",value:this.state.user,onChange:this.createUser.bind(this)}),s.a.createElement("button",{type:"submit"},"Login"))))}},{key:"createUser",value:function(e){this.setState({user:e.target.value})}},{key:"handleSubmit",value:function(){var e=Object(v.a)(f.a.mark(function e(t){var a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,fetch("http://localhost:3002/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:this.state.user})});case 4:return a=e.sent,e.next=7,a.json();case 7:n=e.sent,b.id=n._id,b.name=n.user,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:this.props.history.push("/chat");case 16:case"end":return e.stop()}},e,this,[[1,12]])}));return function(t){return e.apply(this,arguments)}}()}]),t}(s.a.Component),y=a(17),k=a(15),E=a(49),j=a.n(E),O=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={loginuser:b.name,inputValue:"",users:[],messages:[],login:""},a.message=a.message.bind(Object(k.a)(a)),a.onSubmit=a.onSubmit.bind(Object(k.a)(a)),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("div",{className:"mainbox"},s.a.createElement("aside",{className:"contacts"},this.state.users.map(function(t){return t.name!==e.state.loginuser?s.a.createElement("div",{className:"user",key:t.id},s.a.createElement("span",{className:"state"},s.a.createElement("i",{className:"fa fa-circle"})),s.a.createElement("p",{className:"name"},t.name),s.a.createElement("i",{className:"fa fa-ellipsis-v"})):null})),s.a.createElement("div",{className:"conversation"},s.a.createElement("div",{className:"close-chat"},s.a.createElement("p",null,"Close conversation")),s.a.createElement("div",{className:"chat",key:"chat"},this.state.messages.map(function(e){return s.a.createElement("div",{className:"message",key:e.id},s.a.createElement("p",{className:"username"},e.user," ",s.a.createElement("span",null,e.date)),s.a.createElement("p",{className:"text"},e.body))})),s.a.createElement("div",{className:"type-zone"},s.a.createElement("input",{className:"send",id:"send",value:this.state.inputValue,onKeyPress:this.onSubmit,onChange:this.message}),s.a.createElement("i",{className:"far fa-smile"})))))}},{key:"componentDidMount",value:function(){var e=this;this.getUsers(),this.getMessages(),this.socket=j()("http://localhost:3002/"),this.socket.emit("login",{user:b.name}),this.socket.on("user-connected",function(t){console.log(t.user),e.setState({login:t.user,users:e.state.users.concat({name:t.user})})}),this.socket.on("user-disconnected",function(t){var a=e.state.users.filter(function(e){return e.name!==t.user});console.log(a),e.setState({users:a})}),this.socket.on("new-message",function(t){e.setState({messages:e.state.messages.concat(t),inputValue:""})})}},{key:"getUsers",value:function(){var e=Object(v.a)(f.a.mark(function e(){var t,a,n,s;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:3002/api/users");case 3:return t=e.sent,e.next=6,t.json();case 6:a=e.sent,n=this.state.users,s=a.map(function(e){return{id:e._id,name:e.user}}),this.setState({users:[].concat(Object(y.a)(n),Object(y.a)(s))}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}},e,this,[[0,12]])}));return function(){return e.apply(this,arguments)}}()},{key:"getMessages",value:function(){var e=Object(v.a)(f.a.mark(function e(){var t,a,n,s;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:3002/api/messages");case 3:return t=e.sent,e.next=6,t.json();case 6:return a=e.sent,n=this.state.messages,e.next=10,a.map(function(e){return{id:e._id,user:e.user,body:e.body,date:e.date}});case 10:s=e.sent,this.setState({messages:[].concat(Object(y.a)(n),Object(y.a)(s))}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0);case 17:case"end":return e.stop()}},e,this,[[0,14]])}));return function(){return e.apply(this,arguments)}}()},{key:"dateNow",value:function(){var e=new Date,t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],a=e.getDate(),n=e.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});return t.concat(" ",a," ",n)}},{key:"message",value:function(e){this.setState({inputValue:e.target.value})}},{key:"onSubmit",value:function(e){if("Enter"===e.key){var t={user:b.name,body:this.state.inputValue,date:this.dateNow()};this.socket.emit("new-message",t)}}}]),t}(s.a.Component),w=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement(h.a,null,s.a.createElement(p.a,{exact:!0,path:"/",component:g}),s.a.createElement(p.a,{path:"/chat",component:O}))}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(s.a.createElement(w,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[53,1,2]]]);
//# sourceMappingURL=main.868dbc30.chunk.js.map